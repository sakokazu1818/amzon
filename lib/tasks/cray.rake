namespace :cray do
  desc "エクセル読み書き"
  task :run => :environment do
    write_arr = []
    File.open("#{Rails.root}/tmp/master.txt") do |file|
      file.each_line do |row|
        tmp = []
        result = []
        row.split(' ').each_with_index do |a, i|
          if i == 0 || i == 1
            result << a
          else
            tmp << a
          end
        end
        result << tmp.join(' ')
        write_arr << result
      end
    end

    File.open("#{Rails.root}/tmp/master_arr.txt","w") do |text|
      write_arr.each do |w|
        text.print(w)
        text.print(',')
        text.puts('')
      end
    end

    # write_arr = [["17", "27TR2", "27T & ^31KN"],
    # ["18", "2RB1T", "2RB1T"],
    # ["19", "2RB2T", "2RB2T"],
    # ["20", "21 ﾛ TN ", "21 ﾛ T & ^21KR"],
    # ["21", "21 ﾛ TR", "21 ﾛ T & ^21KN"],
    # ["22", "25TN", "25T & ^25KR & ^26KR"],
    # ["23", "25TR1", "25T & ^25KN"],
    # ["24", "25TR2", "25T & ^26KN"],
    # ["25", "31TN", "31T & ^31KR & ^27KR"],
    # ["26", "31TR1", "31T & ^31KN"],
    # ["27", "31TR2", "31T & ^27KN"],
    # ["28", "9LB2T", "9LB2T"],
    # ["29", "9LB1T", "9LB1T"],
    # ["30", "30TN", "30T & ^30KR"],
    # ["31", "30TR", "30T & ^30KN"],
    # ["32", "26TN", "26T & ^26KR & ^25KR"],
    # ["33", "26TR1", "26T & ^26KN"],
    # ["34", "26TR2", "26T & ^25KN"],
    # ["35", "6LAT", "6LAT"],
    # ["36", "10LB2T", "10LB2T"],
    # ["37", "10LB1T", "10LB1T"],
    # ["38", "29TN", "29T & ^29KR"],
    # ["39", "29TR", "29T & ^29KN"],
    # ["40", "1648T", "1648T"],
    # ["41", "102T", "102T"],
    # ["42", "KAT", "KAT"],
    # ["43", "KBT", "KBT"],
    # ["44", "1541T", "1541T"],
    # ["45", "1555T", "1555T"],
    # ["46", "1569T", "1569T"],
    # ["47", "1593T", "1593T"],
    # ["48", "1615T", "1615T"],
    # ["49", "1635T", "1635T"],
    # ["50", "1626T", "1626T"],
    # ["51", "1606T", "1606T"],
    # ["52", "1584T", "1584T"],
    # ["53", "1574T", "1574T"],
    # ["54", "1707T", "1707T"],
    # ["55", "1713T", "1713T"],
    # ["56", "1723T", "1723T"],
    # ["57", "1810T", "1810T"],
    # ["58", "1804T", "1804T"],
    # ["59", "1798T", "1798T"],
    # ["60", "1784T", "1784T"],
    # ["61", "1772T", "1772T"],
    # ["62", "1760T", "1760T"],
    # ["63", "1740T", "1740T"],
    # ["64", "1730T", "1730T"],
    # ["65", "1706T", "1706T"],
    # ["66", "1841T", "1841T"],
    # ["67", "1817T", "1817T"],
    # ["68", "1803T", "1803T"],
    # ["69", "1789T", "1789T"],
    # ["70", "1777T", "1777T"],
    # ["71", "1753T", "1753T"],
    # ["72", "1550T", "1550T"],
    # ["73", "1556T", "1556T"],
    # ["74", "1816T", "1816T"],
    # ["75", "1828T", "1828T"],
    # ["76", "1840T", "1840T"],
    # ["77", "1852T", "1852T"],
    # ["78", "1864T", "1864T"],
    # ["79", "1876T", "1876T"],
    # ["80", "1888T", "1888T"],
    # ["81", "1693T", "1693T"],
    # ["82", "1564T", "1564T"],
    # ["83", "1594T", "1594T"],
    # ["84", "1616T", "1616T"],
    # ["85", "1636T", "1636T"],
    # ["86", "1607T", "1607T"],
    # ["87", "1583T", "1583T"],
    # ["88", "1529T", "1529T"],
    # ["89", "1718T", "1718T"],
    # ["90", "1768T", "1768T"],
    # ["91", "1778T", "1778T"],
    # ["92", "1792T", "1792T"],
    # ["93", "1846T", "1846T"],
    # ["94", "1858T", "1858T"],
    # ["95", "1870T", "1870T"],
    # ["96", "1882T", "1882T"],
    # ["97", "1827T", "1827T"],
    # ["98", "1765T", "1765T"],
    # ["99", "1743T", "1743T"],
    # ["100", "1542T", "1542T"],
    # ["101", "1822T", "1822T"],
    # ["102", "1834T", "1834T"]]

    # xlsx_io = ExcelxIo.new("#{Rails.root}/tmp/施設情報マスター.xlsx", 4)
    # xlsx_io.write(write_arr, 'cray')
  end
end